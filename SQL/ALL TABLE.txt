CREATE TABLE tblDept (
    deptCode int,
    deptName varchar(40),
    deptShortName varchar(5),

    PRIMARY KEY(deptCode)
);

CREATE TABLE tblReferee(
    refereeID int,
    refName varchar(40),
    refInstitute varchar(40),

    PRIMARY KEY(refereeID)
);

CREATE TABLE tblPlayer(
     playerRegNo int,
     playerSession varchar(10),
     playerSemester int,
     playerName varchar(50),
     playerdeptCode int,

    PRIMARY KEY(playerRegNo),

    FOREIGN KEY(playerdeptCode) REFERENCES tblDept(deptCode)
);

CREATE TABLE tblTournament(
    tournamentId int,
    tournamentName varchar(40),
    tournamentYear varchar(20),

    PRIMARY KEY(tournamentId)
);

CREATE TABLE tblTeam(
    tournamentId int,

    teamSubmissionDate date,
    deptCode int,
    deptHead varchar(50),
    teamManager varchar(50),
    teamCaptainRegID int,

    player1RegNo int,
    player2RegNo int,
    player3RegNo int,
    player4RegNo int,
    player5RegNo int,
    player6RegNo int,
    player7RegNo int,
    player8RegNo int,
    player9RegNo int,
    player10RegNo int,
    player11RegNo int,
    player12RegNo int,
    player13RegNo int,
    player14RegNo int,
    player15RegNo int,
    player16RegNo int,
    player17RegNo int,
    player18RegNo int,
    player19RegNo int,
    player20RegNo int,


    PRIMARY KEY (tournamentId, deptCode),


    FOREIGN KEY(deptCode) REFERENCES tblDept(deptCode),
    FOREIGN KEY(teamCaptainRegID) REFERENCES tblPlayer(playerRegNo),

    FOREIGN KEY(player1RegNo) REFERENCES tblPlayer(playerRegNo),
    FOREIGN KEY(player2RegNo) REFERENCES tblPlayer(playerRegNo),
    FOREIGN KEY(player3RegNo) REFERENCES tblPlayer(playerRegNo),
    FOREIGN KEY(player4RegNo) REFERENCES tblPlayer(playerRegNo),
    FOREIGN KEY(player5RegNo) REFERENCES tblPlayer(playerRegNo),
    FOREIGN KEY(player6RegNo) REFERENCES tblPlayer(playerRegNo),
    FOREIGN KEY(player7RegNo) REFERENCES tblPlayer(playerRegNo),
    FOREIGN KEY(player8RegNo) REFERENCES tblPlayer(playerRegNo),
    FOREIGN KEY(player9RegNo) REFERENCES tblPlayer(playerRegNo),
    FOREIGN KEY(player10RegNo) REFERENCES tblPlayer(playerRegNo),
    FOREIGN KEY(player11RegNo) REFERENCES tblPlayer(playerRegNo),
    FOREIGN KEY(player12RegNo) REFERENCES tblPlayer(playerRegNo),
    FOREIGN KEY(player13RegNo) REFERENCES tblPlayer(playerRegNo),
    FOREIGN KEY(player14RegNo) REFERENCES tblPlayer(playerRegNo),
    FOREIGN KEY(player15RegNo) REFERENCES tblPlayer(playerRegNo),
    FOREIGN KEY(player16RegNo) REFERENCES tblPlayer(playerRegNo),
    FOREIGN KEY(player17RegNo) REFERENCES tblPlayer(playerRegNo),
    FOREIGN KEY(player18RegNo) REFERENCES tblPlayer(playerRegNo),
    FOREIGN KEY(player19RegNo) REFERENCES tblPlayer(playerRegNo),
    FOREIGN KEY(player20RegNo) REFERENCES tblPlayer(playerRegNo),

    FOREIGN KEY(tournamentId) REFERENCES tblTournament(tournamentId)
);

CREATE TABLE tblMatch (
    tournamentId int,
    matchID int,
    matchDate date,
    team1_deptCode int,
    team2_deptCode int,
    team1_goal_number int,
    team2_goal_number int,
    winner_team int,
    matchRefereeID int,
    matchLineman1ID int,
    matchLineman2ID int,
    matchFourthRefereeID int,

    PRIMARY KEY (tournamentId, matchID),

    FOREIGN KEY (team1_deptCode) REFERENCES tblDept(deptCode),
    FOREIGN KEY (team2_deptCode) REFERENCES tblDept(deptCode),
    FOREIGN KEY (winner_team) REFERENCES tblDept(deptCode),
    FOREIGN KEY (matchRefereeID) REFERENCES tblReferee(refereeID),
    FOREIGN KEY (matchLineman1ID) REFERENCES tblReferee(refereeID),
    FOREIGN KEY (matchLineman2ID) REFERENCES tblReferee(refereeID),
    FOREIGN KEY (matchFourthRefereeID) REFERENCES tblReferee(refereeID),
    FOREIGN KEY (tournamentId) REFERENCES tblTournament(tournamentId)
);

CREATE TABLE tblIndividualPunishment (
    tournamentId INT,
    matchID INT,
    playerRegNo INT,
    team_deptCode INT,
    punishmentType VARCHAR(10),

    PRIMARY KEY (tournamentId, matchID, playerRegNo),

    FOREIGN KEY (tournamentId, matchID) REFERENCES tblMatch(tournamentId, matchID),
    FOREIGN KEY (playerRegNo) REFERENCES tblPlayer(playerRegNo),
    FOREIGN KEY (team_deptCode) REFERENCES tblDept(deptCode)
);

CREATE TABLE tblIndividualScore(
    tournamentId int,

    matchID int,
    playerRegNo int,
    team_deptCode int,
    goals int,

    PRIMARY KEY (tournamentId, matchID, playerRegNo),

    FOREIGN KEY (tournamentId, matchID) REFERENCES tblMatch(tournamentId, matchID),
    FOREIGN KEY(playerRegNo) REFERENCES tblPlayer(playerRegNo),
    FOREIGN KEY (team_deptCode) REFERENCES tblDept(deptCode)
);

CREATE TABLE tblTiebreaker(
    tournamentId int,

    matchID int,
    team1_deptCode int,
    team2_deptCode int,

    team1_tieBreakerScore int,
    team2_tieBreakerScore int,

    PRIMARY KEY (tournamentId, matchID),

    FOREIGN KEY (tournamentId, matchID) REFERENCES tblMatch(tournamentId, matchID),
    FOREIGN KEY (team1_deptCode) REFERENCES tblDept(deptCode),
    FOREIGN KEY (team2_deptCode) REFERENCES tblDept(deptCode)
);
